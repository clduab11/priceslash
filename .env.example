# =============================================================================
# pricehawk - Environment Variables
# Copy this file to .env.local and fill in your values
# =============================================================================

# =============================================================================
# Database (Local PostgreSQL via Docker or Neon for production)
# =============================================================================
DATABASE_URL="postgresql://postgres:postgres@localhost:5432/pricehawk"

# For Neon (production):
# DATABASE_URL="postgresql://user:password@ep-xxx.us-east-2.aws.neon.tech/pricehawk?sslmode=require"

# =============================================================================
# Clerk Authentication
# Get these from: https://dashboard.clerk.com
# =============================================================================
NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY=pk_test_...
CLERK_SECRET_KEY=sk_test_...
NEXT_PUBLIC_CLERK_SIGN_IN_URL=/sign-in
NEXT_PUBLIC_CLERK_SIGN_UP_URL=/sign-up
NEXT_PUBLIC_CLERK_AFTER_SIGN_IN_URL=/dashboard
NEXT_PUBLIC_CLERK_AFTER_SIGN_UP_URL=/dashboard

# =============================================================================
# Stripe Billing
# Get these from: https://dashboard.stripe.com/apikeys
# =============================================================================
STRIPE_SECRET_KEY=sk_test_...
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_test_...
STRIPE_WEBHOOK_SECRET=whsec_...

# Stripe Price IDs - Monthly (create products in Stripe Dashboard first)
# Dashboard → Products → Add product → Copy the Price ID
STRIPE_PRICE_STARTER=price_...
STRIPE_PRICE_PRO=price_...
STRIPE_PRICE_ELITE=price_...

# Stripe Price IDs - Annual (create annual variants of each product)
STRIPE_PRICE_STARTER_ANNUAL=price_...
STRIPE_PRICE_PRO_ANNUAL=price_...
STRIPE_PRICE_ELITE_ANNUAL=price_...

# =============================================================================
# Scraping APIs (Multi-provider system)
# Priority: Firecrawl → Jina.ai fallback, Tavily for discovery
# =============================================================================

# Firecrawl (Primary): https://firecrawl.dev
# Best for: Structured extraction, anti-bot handling
# Cost: $0.83 per 1K pages (Standard plan)
FIRECRAWL_API_KEY=fc-...

# Tavily (Discovery): https://tavily.com
# Best for: Web search, discovering product pages
# Cost: $8 per 1K credits (basic search)
TAVILY_API_KEY=tvly-...

# Jina.ai Reader (Fallback): https://jina.ai/reader
# Best for: Markdown extraction, works without key (rate limited)
# Cost: Free tier friendly, token-based pricing
JINA_API_KEY=jina_...

# Perplexity (Research): https://www.perplexity.ai/api
# Best for: Market research, competitive intelligence
# Cost: $5 per 1K search requests
PERPLEXITY_API_KEY=pplx-...

# =============================================================================
# AI Validation (OpenRouter - Weighted Multi-Model Routing)
# Get API key from: https://openrouter.ai
#
# Architecture:
# - Standard Tier: Top 12 free models with weighted round-robin
# - SOTA Tier: Premium models (Claude, GPT-4, Gemini Pro) for "unicorn" opportunities
#
# Unicorn Detection (auto-escalates to SOTA):
# - Discount > 85% with high confidence
# - Z-score > 4.5 (extreme anomaly)
# - High-value items ($500+) with 70%+ discount
# - Decimal error patterns detected
# =============================================================================
OPENROUTER_API_KEY=sk-or-...

# Enable SOTA models for unicorn opportunities (costs ~$0.003-0.005/1K tokens)
# Set to "false" to use only free models (default: true)
ENABLE_SOTA_MODELS=true

# =============================================================================
# AI Enrichment (Jina.ai Reranker)
# Get API key from: https://jina.ai
# Used for optional reranking of validated glitches by virality/honor probability
# =============================================================================
JINA_API_KEY=jina_...
# Set to "true" to enable Jina reranking after DeepSeek validation (default: false)
USE_JINA_RERANK=false

# =============================================================================
# beehiiv Newsletter Integration
# Get API key from: https://app.beehiiv.com/settings/api
# Used for publishing daily "Top X glitches" newsletter to ad-supported list
# =============================================================================
BEEHIIV_API_KEY=...
BEEHIIV_PUBLICATION_ID=pub_...
# Set to "true" to enable beehiiv newsletter publishing (default: false)
USE_BEEHIIV_DIGEST=false

# =============================================================================
# Redis (Local Docker or Upstash)
# Recommended: Upstash for production (pay-per-use, $0.20/100K commands)
# =============================================================================

# Local development:
REDIS_URL=redis://localhost:6379
REDIS_HOST=localhost
REDIS_PORT=6379

# For Upstash (production - RECOMMENDED):
# UPSTASH_REDIS_REST_URL=https://...upstash.io
# UPSTASH_REDIS_REST_TOKEN=...

# =============================================================================
# Notification Channels
# =============================================================================
# Discord Webhook: Server Settings → Integrations → Webhooks
DISCORD_WEBHOOK_URL=https://discord.com/api/webhooks/...

# Twitter/X API (for bot posting)
TWITTER_API_KEY=...
TWITTER_API_SECRET=...
TWITTER_ACCESS_TOKEN=...
TWITTER_ACCESS_SECRET=...
# Client ID for OAuth 2.0
TWITTER_CLIENT_ID=...
TWITTER_CLIENT_SECRET=...

# Telegram Bot
TELEGRAM_BOT_TOKEN=...
TELEGRAM_CHANNEL_ID=@your_channel_name

# WhatsApp Business API
WHATSAPP_ACCESS_TOKEN=...
WHATSAPP_PHONE_NUMBER_ID=...
WHATSAPP_BUSINESS_ACCOUNT_ID=...

# Discord Bot (optional, for DMs)
DISCORD_BOT_TOKEN=...
DISCORD_CHANNEL_ID=...

# Twilio SMS: https://console.twilio.com
TWILIO_ACCOUNT_SID=AC...
TWILIO_AUTH_TOKEN=...
TWILIO_PHONE_NUMBER=+1...
# Comma-separated list of phone numbers to notify (e.g. "+15551234567,+15557654321")
SMS_NOTIFY_NUMBERS=

# Resend Email: https://resend.com
RESEND_API_KEY=re_...

# Facebook Graph API (optional)
FACEBOOK_PAGE_ID=...
FACEBOOK_PAGE_ACCESS_TOKEN=...

# =============================================================================
# Application Settings
# =============================================================================
NEXT_PUBLIC_APP_URL=http://localhost:3000
NODE_ENV=development

# Launch Period Configuration
# Set to your PRD-production launch date (all users get Pro features during 60-day period)
LAUNCH_DATE=2026-02-01T00:00:00Z
NEXT_PUBLIC_LAUNCH_DATE=2026-02-01T00:00:00Z

# Worker settings
SCRAPER_CONCURRENCY=5

# Stream worker settings (optional)
STREAM_BATCH_SIZE=50
STREAM_POLL_INTERVAL_MS=2000
STREAM_MAX_RETRIES=5
NOTIFY_DEDUP_TTL_SECONDS=86400

# Database pool size
DATABASE_POOL_SIZE=10

# =============================================================================
# Cron & Admin Security
# Generate with: openssl rand -hex 32
# =============================================================================
CRON_SECRET=your-cron-secret-here
ADMIN_SECRET=your-admin-secret-here

# =============================================================================
# Cost Optimization Notes (January 2026)
# =============================================================================
# Estimated monthly costs at low volume (testing phase):
# - Neon Postgres: Free tier (0.5GB storage, 100hr compute)
# - Upstash Redis: ~$5-10/mo (pay per command)
# - Firecrawl: ~$20-50/mo (depends on scrape volume)
# - OpenRouter (Multi-Model):
#   - Standard tier: $0 (12 free models with weighted routing)
#   - SOTA tier: ~$2-10/mo (only for unicorn opportunities, ~5% of calls)
# - Vercel: Free tier (hobby) or $20/mo (Pro)
# - Railway (workers): ~$5/mo (usage-based)
#
# Total estimated: $30-90/mo for testing
#
# AI Model Routing:
# - 95% of requests: Free tier models (Gemini Flash, Llama 3.3, Qwen, DeepSeek R1)
# - 5% of requests: SOTA models for high-value "unicorn" glitches
# - Automatic fallback and circuit breaker for reliability
#
# Scale with volume - most services are pay-per-use
